if(window.onload){window.onload=window.onload.extend(initForgot);}else{window.onload=initForgot();}
function initForgot(){console.log('forgot');if(document.querySelector('.forgot_page .cleanlogin-form')){document.querySelector('.forgot_page .cleanlogin-form').onsubmit=function(e){e.preventDefault();var forgotForm=e.target;var forgotStatus=forgotForm.querySelector('p.status');forgotStatus.classList.remove('alert-danger');var reqData={'action':'forgot_password','username':forgotForm.querySelector('[name=username]').value,'website':forgotForm.querySelector('[name=website]').value}
postRequest(ajaxEndpoint,reqData,function(data){if(data.status==='ok'){forgotForm.innerHTML='<div class="forgot_success">We have sent an email to you. Please click the link in it.</div>';forgotStatus.classList.remove('alert-danger');}else{forgotStatus.innerHTML=data.message;forgotStatus.classList.add('alert-danger');}});e.preventDefault();}}
if(document.querySelector('#update_password')){document.querySelector('#update_password').onsubmit=function(e){e.preventDefault();var forgotForm=e.target;var forgotStatus=forgotForm.querySelector('p.status');forgotStatus.classList.remove('alert-danger');var reqData={'action':'update_password','key':forgotForm.querySelector('[name=key]').value,'login':forgotForm.querySelector('[name=login]').value,'password':forgotForm.querySelector('[name=password]').value,'password_2':forgotForm.querySelector('[name=password_2]').value}
postRequest(ajaxEndpoint,reqData,function(data){if(data.status==='ok'){forgotForm.innerHTML='<div class="forgot_success">Your password has been updated. Please <a href="/login/">Login</a></div>';forgotStatus.classList.remove('alert-danger');}else{forgotStatus.innerHTML=data.message;forgotStatus.classList.add('alert-danger');}});e.preventDefault();}}}