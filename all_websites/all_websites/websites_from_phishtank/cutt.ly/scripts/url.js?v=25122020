$(document).ready(function(){refreshResults()});function deleteListener(){$(".delete").unbind();$(".delete").click(delUrl);$("input[name=hide]").unbind();restoreListeners();var sticky=new Sticky('[data-sticky]');setTimeout(function(){sticky.update();},150);$('[data-toggle="tooltip"]').tooltip();resetAll();}
function restoreListeners()
{$('input[name=hide]').change(function(){if($('input[name=hide]:checked').length){$('input[name=hideUrls]').removeAttr('disabled');$('input[name=unhide]').removeAttr('disabled');$('input[name=favouriteUrls]').removeAttr('disabled');$('input[name=unfavourite]').removeAttr('disabled');$("input[name=bulk]").removeAttr("disabled");}else{$('input[name=hideUrls]').attr('disabled','disabled');$('input[name=unhide]').attr('disabled','disabled');$('input[name=favouriteUrls]').attr('disabled','disabled');$('input[name=unfavourite]').attr('disabled','disabled');$("input[name=bulk]").attr("disabled","disabled");}});}
function delUrl(e){if(confirm("By removing the link, you won't be able to use its name for 14 days. Are you sure you want to delete this link?")){e.preventDefault();var url=$(this).parent().find("input[name='hide']").val();$.ajax({url:"scripts/deleteUrl.php",data:{url:url,call_id:call_id},method:"post",complete:function(msg){location.reload();}});}}
function refreshResults(){var ajax=new XMLHttpRequest();ajax.open("GET","scripts/getCookies.php",!1);ajax.send();$("#results").empty().html(ajax.responseText);deleteListener();}
function send(){var url=$("input[name=url]").val();$("input[name=url]").val("");var domain=$("input[name='userDomain']");if(domain.length){if($(domain).is(":checked")){domain=1;}else domain=0;}else domain=0;if(url!=""){var form=new FormData();form.append("url",url);form.append("domain",domain);var ajax=new XMLHttpRequest();ajax.open("POST","scripts/shortenUrl.php",false);ajax.send(form);$("input[name=url]").val(ajax.responseText).select();url=$("input[name=url]").val();$(".btn_cutt").html(cpy).attr("onclick","copyToClipboard(this)");refreshResults();displayNotice("Link has been shortened");}}
function copyToClipboard(elem){var url=$(elem).parent().find("#link").val();if(url==="")url=$(elem).parent().find("#link").text();var $temp=$("<input style='position: absolute; top: -1000px; left: -1000px;'>");$("body").append($temp);$temp.val(url).select();document.execCommand("copy");$temp.remove();displayNotice("URL has been copied");}
function restoreBtn(){$(".btn_cutt").empty().html(sho).attr("onclick","send()")}
function changeTag(e){var id=$(e).parent().get(0).id;var link=$("#"+id).find("input[name='hide']").val();var prev=$("#"+id).find("#tag").text();$("#"+id).find("#tag").empty().html("<input type='text' name='tag' id='tagIn' />");$("#tagIn").focus();$("#tagIn").keypress(function(e){if(e.which==13){var name=$("input[id=tagIn]").val();if(typeof name!=="undefined"){var ajax=new XMLHttpRequest();ajax.open("POST","scripts/addTag.php",!1);var form=new FormData();form.append("link",link);form.append("name",name);ajax.send(form)}
$("#tagIn").focusout();refreshResults()}});$("#tagIn").focusout(function(){var name=$("input[id=tagIn]").val();if(!name)
$("#"+id).find("#tag").empty().html(prev);else $("#"+id).find("#tag").empty().html("#"+name+"");refreshResults()})}
var globalTimeout=null;function searchTags(){$('input[name=search]').keyup(function(){if(globalTimeout!=null){clearTimeout(globalTimeout)}
globalTimeout=setTimeout(search,1500)})}
function search(){var tag=$('input[name=search]').val();if(tag){var ajax=new XMLHttpRequest();ajax.open("POST","scripts/getTag.php",!1);var form=new FormData();form.append("tag",tag);ajax.send(form);$("#results").empty().html(ajax.responseText);$('[data-toggle="tooltip"]').tooltip();resetAll();}else{refreshResults();$('[data-toggle="tooltip"]').tooltip();resetAll();}}
function deleteAcc(){if(confirm(confirmation)){var ajax=new XMLHttpRequest();ajax.open("POST","options.php",!1);var form=new FormData();form.append("id","delete");ajax.send(form);alert(deleted);window.location.replace("index.php")}}
function deleteUserFromAllowed(link,id){var ajax=new XMLHttpRequest();ajax.open("POST","scripts/deleteAllowed.php",false);var form=new FormData();form.append("id",id);form.append("link",link);ajax.send(form);window.location.replace(window.location.href);}