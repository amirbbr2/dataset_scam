if(window.onload){window.onload=window.onload.extend(initLoginScripts);}else{window.onload=initLoginScripts();}
function initLoginScripts(){if(document.querySelector('a#show_login')){document.querySelector('a#show_login').onclick=function(e){FX.fadeIn(document.querySelector(".ajax_login_overlay"),{duration:500,complete:function(){}});FX.fadeIn(document.querySelector("form#login"),{duration:500,complete:function(){}});e.preventDefault();}}
if(document.querySelector('.ajax_login_overlay')){FX.fadeOut(document.querySelector("form#login"),{duration:500,complete:function(){}});FX.fadeOut(document.querySelector(".ajax_login_overlay"),{duration:500,complete:function(){}});hide(document.querySelector('form#register_form'));document.querySelector('.ajax_login .status').innerHTML='';document.querySelector('#registration-error-message').innerHTML='';hide(document.querySelector('form#login'));document.querySelector('form#register_form .field input').value='';}
if(document.querySelector('form.ajax-login-form')){document.querySelector('form.ajax-login-form').onsubmit=function(e){e.preventDefault();var loginForm=e.target;var loginStatus=loginForm.querySelector('p.status');show(loginStatus);loginStatus.innerHTML="Sending user info, please wait...";loginStatus.classList.remove('alert-danger');var reqData={'action':'ajaxlogin','username':loginForm.querySelector('[name=username]').value,'password':loginForm.querySelector('[name=password]').value,'security':loginForm.querySelector('[name=security]').value}
postRequest(ajaxAdminEndpoint,reqData,function(data){loginStatus.innerHTML=data.message;if(data.loggedin===true){document.location.href='/';}else{loginStatus.classList.add('alert-danger');}});e.preventDefault();}}}