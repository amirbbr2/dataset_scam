jQuery(function(a){"use strict";var e=a("body");a(document).on("click",".ywpar-button-message",function(e){e.preventDefault();var t=a(this);t.hasClass("ywpar-button-percentage-discount")?t.next().find("form").submit():a(".ywpar_apply_discounts_container").slideToggle()}),a(document).on("click","#ywpar_apply_discounts",function(e){e.preventDefault();var r=a("#ywpar-points-max").attr("min");if(parseFloat(a("#ywpar-points-max").val())<parseFloat(r))return a(".ywpar_min_reedem_value_error").show(),!1;a(".ywpar_min_reedem_value_error").css("opacity","0"),a("#ywpar_input_points_check").val(1),yith_wpar_general.redeem_uses_ajax?t(a(this).parents("form")):a(this).parents("form").submit()});const t=function(e){r(a("#yith-par-message-reward-cart"));var t={ywpar_points_max:e.find("input[name=ywpar_points_max]").val(),ywpar_max_discount:e.find("input[name=ywpar_max_discount]").val(),ywpar_rate_method:e.find("input[name=ywpar_rate_method]").val(),ywpar_input_points_nonce:e.find("#ywpar_input_points_nonce").val(),ywpar_input_points:e.find("#ywpar-points-max").val(),ywpar_input_points_check:e.find("#ywpar_input_points_check").val()};a.ajax({type:"POST",url:yith_wpar_general.wc_ajax_url.toString().replace("%%endpoint%%","ywpar_apply_points"),data:t,dataType:"html",success:function(a){console.log("ywpar_applied")},complete:function(){"cart"===yith_wpar_general.cart_or_checkout?(a(".woocommerce-cart-form button[name=update_cart]").removeAttr("disabled"),a(".woocommerce-cart-form button[name=update_cart]").click()):a("body").trigger("update_checkout")}})};var r=function(a){(function(a){return a.is(".processing")||a.parents(".processing").length})(a)||a.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})};a.fn.yith_ywpar_variations=function(e){var t=(e=a(".variations_form:not(.in_loop )")).closest(".product").find(".yith-par-message"),r=e.closest(".product").find(".yith-par-message-variation");t.length||(t=a(".product").find(".yith-par-message"),r=a(".product").find(".yith-par-message-variation")),t.length||(t=a(".yith-par-message"),r=a(".yith-par-message-variation"));var n=r.find(".product_point"),o=r.find(".product-point-conversion");e.on("found_variation",function(a,e){t.addClass("hide"),r.removeClass("hide"),0==e.variation_points&&r.addClass("hide"),e.variation_points&&n.text(e.variation_points),e.variation_price_discount_fixed_conversion&&o.html(e.variation_price_discount_fixed_conversion)}),e.on("reset_data",function(){r.addClass("hide"),t.removeClass("hide")}),e.find("select").first().trigger("change")},e.hasClass("single-product")&&a.fn.yith_ywpar_variations(),a(document).on("qv_loader_stop",function(){a.fn.yith_ywpar_variations()}),a(document.body).on("updated_cart_totals, added_to_cart, updated_checkout",function(){var e=a("#yith-par-message-cart");(e.length>0&&a.ajax({url:yith_wpar_general.wc_ajax_url.toString().replace("%%endpoint%%","ywpar_update_cart_messages")+"&cart_or_checkout="+yith_wpar_general.cart_or_checkout,type:"POST",beforeSend:function(){},success:function(a){""!==a?e.show().html(a):e.hide()}}),0===a("#yith-par-message-reward-cart").length)&&a(".woocommerce-form-coupon").after('<div id="yith-par-message-reward-cart" style="display:none" class="woocommerce-cart-notice woocommerce-cart-notice-minimum-amount woocommerce-info"></div>');a(document).find("#yith-par-message-reward-cart").length>0&&a.ajax({url:yith_wpar_general.wc_ajax_url.toString().replace("%%endpoint%%","ywpar_update_cart_rewards_messages"),type:"POST",beforeSend:function(){},success:function(e){let t=a(document).find("#yith-par-message-reward-cart");t.addClass(yith_wpar_general.reward_message_type),""!==e?(t.show().html(e),n()):t.hide()}})});const n=function(){a("#ywpar-points-max").on("keyup",function(e){let t=a(this).val();""!==t&&a.isNumeric(t)||(t=0);var n={input_points:t,max_points:a("#yith-par-message-reward-cart input[name=ywpar_points_max]").val(),method:a("#yith-par-message-reward-cart input[name=ywpar_rate_method]").val()};a.ajax({url:yith_wpar_general.wc_ajax_url.toString().replace("%%endpoint%%","ywpar_calc_discount_value"),type:"POST",data:n,dataType:"html",beforeSend:function(){r(a("#yith-par-message-reward-cart.default-layout .woocommerce-Price-amount"))},success:function(e){""!==e&&a("#yith-par-message-reward-cart .woocommerce-Price-amount").html(e)},complete:function(){a("#yith-par-message-reward-cart.default-layout .woocommerce-Price-amount").removeClass("processing").unblock()}})})};a(document).on("wc_fragments_refreshed",function(){n()}),n()});